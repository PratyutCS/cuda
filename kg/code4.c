#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <stdint.h>
#include <gmp.h>
#include <stdbool.h>
#include <ctype.h>
#include <cuda.h>

uint32_t* sum(uint32_t* a, uint32_t* b, size_t sa, size_t sb, size_t* res) {
    size_t max = (sa > sb) ? sa : sb;
    uint32_t carry = 0;
    uint64_t tmp_sum;
    
    uint32_t* temp_res = (uint32_t*) malloc(max * sizeof(uint32_t));
    if (temp_res == NULL) {
        return NULL;
    }
    for (size_t i = 0; i < max; i++) {
        uint32_t a_num = (i < sa) ? a[sa - 1 - i] : 0;
        uint32_t b_num = (i < sb) ? b[sb - 1 - i] : 0;
        tmp_sum = (uint64_t)a_num + (uint64_t)b_num + (uint64_t)carry;
        temp_res[max - 1 - i] = (uint32_t) (tmp_sum & 0xFFFFFFFF);
        carry = (uint32_t) (tmp_sum >> 32);
    }
    
    if (carry) {
        uint32_t* result = (uint32_t*) malloc((max + 1) * sizeof(uint32_t));
        if (result == NULL) {
            free(temp_res);
            return NULL;
        }
        result[0] = (uint32_t) carry;
        for (size_t i = 0; i < max; i++) {
            result[i + 1] = temp_res[i];
        }
        free(temp_res);
        *res = max + 1;
        return result;
    } else {
        *res = max;
        return temp_res;
    }
}

uint32_t* diff(uint32_t* a, uint32_t* b, size_t sa, size_t sb, size_t* res) {
    size_t max = (sa > sb) ? sa : sb;
    uint32_t* sub_str = (uint32_t*) malloc(max * sizeof(uint32_t));
    uint32_t borrow = 0;
    
    for (int i = 0; i < max; i++) {
        uint32_t a_num = (i < sa) ? a[sa - 1 - i] : 0;
        uint32_t b_num = (i < sb) ? b[sb - 1 - i] : 0;
        
        uint64_t diff_val;
        if (a_num < (b_num + borrow)) {
            diff_val = (uint64_t)a_num + ((uint64_t)1 << 32) - (uint64_t)b_num - (uint64_t)borrow;
            borrow = 1;
        } else {
            diff_val = (uint64_t)a_num - (uint64_t)b_num - (uint64_t)borrow;
            borrow = 0;
        }
        sub_str[max -1 -i] = (uint32_t) (diff_val & 0xFFFFFFFF) ;
    }
    if(borrow){
        printf("borrow found with no location to place it\n");
    }
    
    *res = max;
    return sub_str;
}

uint32_t* multiply(uint32_t* num1, uint32_t* num2, size_t s1, size_t s2, size_t* res){
    size_t max = s1 > s2 ? s1 : s2;
    
    if(max == 1){
        if(s1 == 0 || s2 == 0){
            uint32_t* mul = (uint32_t*) malloc(1 * sizeof(uint32_t));
            mul[0] = (uint32_t) 0;
            *res = 1;
            return mul;
        }
        *res = 2;
        uint32_t* mul = (uint32_t*) malloc(2 * sizeof(uint32_t));
        uint64_t im_mul = (uint64_t) num1[0] * (uint64_t) num2[0];
        mul[1] = (uint32_t) (im_mul & 0xFFFFFFFF);
        mul[0] = (uint32_t) (im_mul >> 32);
        return mul;
    }

    max = (max % 2 == 0) ? max : max + 1;

    size_t pad1 = max-s1;
    size_t pad2 = max-s2;

    uint32_t* p_num1 = (uint32_t*) malloc(max * sizeof(uint32_t));
    uint32_t* p_num2 = (uint32_t*) malloc(max * sizeof(uint32_t));

    for(int i=0 ; i<pad1 ; i++){
        p_num1[i] = (uint32_t) 0;
    }
    for(int i=pad1 ; i<max ; i++){
        p_num1[i] = num1[i-pad1];
    }
    
    for(int i=0 ; i<pad2 ; i++){
        p_num2[i] = (uint32_t) 0;
    }
    for(int i=pad2 ; i<max ; i++){
        p_num2[i] = num2[i-pad2];
    }

    uint32_t* a = (uint32_t*) malloc((max/2) * sizeof(uint32_t));
    memcpy(a, p_num1, max/2  * sizeof(uint32_t));
    uint32_t* b = (uint32_t*) malloc((max/2) * sizeof(uint32_t));
    memcpy(b, p_num1+(max/2), max/2 * sizeof(uint32_t));
    
    uint32_t* c = (uint32_t*) malloc((max/2) * sizeof(uint32_t));
    memcpy(c, p_num2, max/2 * sizeof(uint32_t));
    uint32_t* d = (uint32_t*) malloc((max/2) * sizeof(uint32_t));
    memcpy(d, p_num2+(max/2), max/2 * sizeof(uint32_t));

    size_t s_ac, s_bd;
    uint32_t* ac = multiply(a, c, max/2, max/2, &s_ac);
    uint32_t* bd = multiply(b, d, max/2, max/2, &s_bd);

    size_t s_a_plus_b, s_c_plus_d; 
    uint32_t* a_plus_b = sum(a, b ,max/2 ,max/2, &s_a_plus_b);
    uint32_t* c_plus_d = sum(c, d ,max/2 ,max/2, &s_c_plus_d);

    size_t s_a_plus_b_times_c_plus_d;
    uint32_t* a_plus_b_times_c_plus_d = multiply(a_plus_b, c_plus_d, s_a_plus_b, s_c_plus_d, &s_a_plus_b_times_c_plus_d);

    size_t s_diff1, s_diff2;
    uint32_t* diff1 = diff(a_plus_b_times_c_plus_d, ac, s_a_plus_b_times_c_plus_d, s_ac, &s_diff1);
    uint32_t* diff2 = diff(diff1, bd, s_diff1, s_bd, &s_diff2);

    uint32_t* shifted_ac = (uint32_t*) malloc( (s_ac+max) * sizeof(uint32_t));

    for( size_t i=0 ; i<(s_ac+max) ; i++){
        shifted_ac[i] = (i<s_ac) ? ac[i] : (uint32_t) 0;
    }

    uint32_t* shifted_diff2 = (uint32_t*) malloc( (s_diff2+(max/2)) * sizeof(uint32_t));

    for( size_t i=0 ; i<(s_diff2+(max/2)) ; i++){
        shifted_diff2[i] = (i<s_diff2) ? diff2[i] : (uint32_t) 0;
    }

    size_t s_sum1, s_sum2;
    uint32_t* sum1 = sum( shifted_ac, shifted_diff2, (s_ac+max), (s_diff2+(max/2)), &s_sum1);
    uint32_t* sum2 = sum( sum1, bd, s_sum1, s_bd, &s_sum2);

    free(p_num1);
    free(p_num2);
    free(a);
    free(b);
    free(c);
    free(d);
    free(ac);
    free(bd);
    free(a_plus_b);
    free(c_plus_d);
    free(a_plus_b_times_c_plus_d);
    free(diff1);
    free(diff2);
    free(sum1);
    free(shifted_ac);
    free(shifted_diff2);

    *res = s_sum2;
    return sum2;
}

char* gen(long long length) {
    char* hex_string = (char*)malloc((length + 1) * sizeof(char));
    if (hex_string == NULL) {
        return NULL;
    }
    
    const char hex_chars[] = "0123456789ABCDEF";
    for (long long i = 0; i < length; i++) {
        long long random_index = rand() % 16;
        hex_string[i] = hex_chars[random_index];
    }
    hex_string[length] = '\0';
    return hex_string;
}

char* uint32_array_to_hex(uint32_t* arr, size_t size) {
    if (!arr || size == 0) return NULL;
    
    size_t hex_str_size = (size * 8) + 1;
    char* hex_str = (char*)malloc(hex_str_size);
    if (!hex_str) {
        perror("Memory allocation failed");
        return NULL;
    }
    
    char* ptr = hex_str;
    for (size_t i = 0; i < size; i++) {
        sprintf(ptr, "%08X", arr[i]);
        ptr += 8;
    }
    *ptr = '\0'; // Null-terminate the string
    
    return hex_str;
}

bool compare_strings(char *str1, char *str2) {

    size_t len2 = strlen(str2);
    char *str3 = (char*)malloc(len2 + 1 * sizeof(char));
    if (!str3) {
        fprintf(stderr, "Memory allocation failed.\n");
        exit(EXIT_FAILURE);
    }

    for (size_t i = 0; i < len2; i++) {
        str3[i] = toupper((unsigned char)str2[i]);
    }
    str3[len2] = '\0';

    size_t length1 = strlen(str1);
    size_t length2_actual = strlen(str3);
    
    size_t min_length = (length1 < length2_actual) ? length1 : length2_actual;
    
    for (size_t i = 0; i < min_length; i++) {
        if (str1[length1 - 1 - i] != str3[length2_actual - 1 - i]) {
            printf("Difference found: %c from str1 vs %c from str3\n",
                   str1[length1 - 1 - i], str3[length2_actual - 1 - i]);
            free(str3);
            return false;
        }
    }
    free(str3);
    return true;
}

int main() {
    srand((unsigned int)time(NULL));

    for (long long i = 1; i <= 1; i++) {
        printf("========== TEST %lld ==========\n", i);
        // Generate host strings
        char* num1 = "F27FBB1E87859EC5F7472EBA936AAF7185F47796E2BEFEBFCED54FF42CDBBB4BF3E627BF8D5F4F6F5358A4BB7FE2A2C9B26C99B8D1717C8C7CB17E35D1D89285361364B3B9B2D35461B46D83E5276231E434E5D9EF2B9E66619BD85357A2FC257C8C1CC6CE8CC5395B4AB8CF6D8C2A1FDFC5C8BFDAB1FD9B1C5BC9296967A6E7DAC92EFF8A7EF1AF462FE39CB6A6384F9FFBDE2D18BF8CECAF3F93B4FD135C96B91979D78868CBBD2DCA8F67CD989AD53551528D15548F1945BB4137D36ECB367E7CF6172539B3AEE5A9C479D5EA71FDED153145C6D7FE6637E6A67725886F5BCD8FD34AF8167DB14AED75C894F63B9F81E6A9798EE6C277B5591889B7F698C2F2E1AC92AE8DF65221A2892A71F1FB26C76D3E745624B6D46EC58DEE6EE517B5D827E8B3DCDF9A369EA148E9D5D6BFA1FB7DB2FF547DE93EF4E34438FFDB7736A93C39B7C2C236F9A53515CFBA2914625FD7815C98DBEDBF95499F9C125963A22FFAFBD84AB9ED88331391EA3B3FD4163F72A425E4D41CB3E4684B2DDBC2EC823EA53B18EEB7AE99268C91ADB679AE2444FD61C5EF3FD386179173D214329B55EC95C612C319516C7ECE9A715926CDAA9365F66BFEBCE18575AF627A28FDC1FD459A3F6258D396E729D72483388E8EB3A55CB2EF939987F17C787F39E2FDFA896CD8D3E657F5665CA4C13EA8F956AC68F37C56A24169D2D7598E796D9B33E82E392E63F9ACA8E7EA769D6E2E14973AC5A5BF8A19EA1C87DE463AC484E1A136DC384294A753AC182454517D5556C749B68E7291FDAA1A22E65AE3EAE4FA2AB4F32DB26BEF5EAD7FAB985823395B37FA917CAC78C3ED75418C1CB9752B152FE27C5193155E93AC42FBE34C767E2FD7853DCB7C7CA76539D343CFE35596B64B26869E2724EFF18CA4F63D1EA9B56EF8BEDB563D91C88CC373F1F7E9F16D6CC1314766B7DF65B2E94E9BCEB4611B5C37C652BF8F6E51731B81D5688B9FDDB1B7DFF16FFCD44BE56DC393385B73F2A2F71F76EE932DD79B555DE7649CDF671C51B4E12E3AB82BA61EA6DF96466146C9EF44F59AEC9F73CE175DDDB8B8FE5CE332D2673C3B315FFDD42A8CA34999C73E188D6A9FDCF23E6F98124ABFB48732639576E15345C6A25B95457E42A3F44CD514A7B79E3C44E8EE59ABFD417A43787EB8576EC821C7F264B762C123B559C37E3CC8298394A8C74E59F1A14C58583BE5EA4FABA36B339D1D61E712AD16C32AE7CAE6581B335B75FCCDBDEC273D1BF72B1F15E171AB318A54778D314CEB7529F9FF6E8C62F1AEA628C2562F37B9B49AD123696B253BAC1C54D1A684DAC8DD32D4B34255D888B8B74FFD571214258B7562E93BD8A5FC5AB89AC514787FCFA3BFC2864CD594155B4557ACA84878E1227D36BD282242D851D177D8681C7E49FAD9F8688E2B8EAC77CD516A1DD7B1F3A531C19BEA66F89666BBD8CD5A572B1CF44444E95C754FA9C5BACF789BFAEFDDA91DC7E2356D4768492788F8B699C7D7F6B3494659318F8BF99788E35F32688CDAE84AD8A782D74DFDB8C222153D4218B6F6FC6AADBE5FBB4EAFFC1F8A4B343699B9C1A66C4237C6576BA622854AFDF8638239EF6918F5EB346C1E5F3822C12231ADA8CF85EF9CA378EF6AE12F2D8A62BFECE33671C7579B6EAB81B1F5576A181E468D36EF4AD45327D1711DCCC2DC2D25A2A57F439165AFBEF968E242B2DC6688E2C61FF9756141642C37D688ECB594C8585DE46C8B4449EC51336A2CDD8614DC329857459784F6F569E3A7E7B65312FABF2FDC47AB2289DD2B849625467B8D6ADE9A358C7A5F324BCBED9124D8ECDB6A2FBBB4E254175C297867F7AC61933E445F6FA52E89545DC4C22BFC8D4876D3232723BA1ABCEF12ADBCFAFEE36DF4F1D88EAA1ACBD22D342DF2F6F58D2788F5FEA98AABCECEC725B862DD7CAFA289D7E78792958DA443FEAD8EAE2BD44C41437B1F49CB66619D7AAE94426859591FBE2BE5BA82759F2FA35A68331835834325571F8F8EC2658F8D15538C2A19DB367ECF64ED226776DE353EF2B8C3216B6CA2BF524DA2C17161616C2145BC5182493FFE8342B7A27F247F79FB52E29D3D6D4C3BFD424D435CDBB5B3F1B5953328F55A7B7AC3F754426662FC9B29FBB13BCECA13B55AB1563B4F4344DCCC77419775178CB4DE5ABE5E5F9836BEA9CDA6C1ACE9F2D572E27A8B91B3D687F4C1988BB643E1E59C77D636D5FA279125834FDED88B96199E16BA38E29FF282D741E87BFEDFC59531B52D477DD6657442B212C181F46FFF7A58FF66C4BAFA533F4497B182BD9ACF58FB851BF35F49271629441B5BFD5451BBBA7367D26137EA4738A3A75AB15F2F2429EEFBF539323E8C6A671A8BBC34C4E5CC3BE97232ACF29C363A8B6A7FDA33E77895286B9F789743D6DC8A679A13C793E3FFAC2A492C7C6B9372CC8C6FFA684523B3F5C3D56B1B7A65329A6615F7443DD57C946DFB91E724B4C452A56132B5E9A55AFB87D87BEFE9AB5EC6AA6DB291AAC65C8436B11977912565AF68411D82E5E38762C8941FA27B6C883D776EBDF99DC8B99722B9852E88A7754DB1B6626E6972378B1AB87DE6CFC347FE82BD32B8299B19D8A9F1D56959BF12E8A1CC9EBB8C6F5B764D78A41E53D5B345BF8BD3DC6B3A61196E1F985D299C4C8E3F119E4F971E78ECD63757B6852B1914F1B86EEE5F44E97C6AAA85FF982212C7A77FC569B1C223D74724383C1558D1FEED6A2B3536641A348B7A32DAD2329917662E8BA227D21FCF2BA44E618F21F98CE12DBCF43C5B39A44BE7A4E2A729115617B4AA7CD4E7C9A7BFD543D597E17A7F123A31E74CDFC7D86A41C26D8BD65BC64E767C42912CE64518C419884659826C749D1DF958C4D1F5FB1F58EF53FDB5131971DD13CC6245D37D23DFA2A96566E67664ADD79A8D657DA977F1F9A66FB4C9995B622641A9C2D6254154AE975BA15B19662E45EDE263F7738CD926FE9165B75146E734C862AC12EF5CF69EB962D2F293FF223D9F6AB6B2C7DB5D1F778B87D12CF35A751CECA256892C62C484F73CF4FE6BFCF1FD49E8771F3D16212874B672C4C37B36FD7EC5C4462B4AB52A84765A91D737C25A78EAC215D4EFF71EA8469466A85D91888624F284CDA3BB1CA423771865675DE4AFF19EBCC6FE8FB2B4B93B2877E3BCEC4DDCBF8E57DCEF59382CA3521ABB79FA6CD2B57844B2A8A5F3196CAD7D956F64B3CD73CAEF387C46F5EC119ED93A88DAA9F9CBAAAD981DD79C31C4F1C9AC28631C348D592E29361B2A35D25237D4E3D6F1AE5EED4766D68683B5B76DD313D694DA92F76B6B1391F13ACD93BDC319F1CCAC51BAB1D4ADB95D4124341FE8FD84A9FEAA1CADFB2A56EF68313A713DEA1F4855251498EA93FF9D7B59632FF79164F28871B7F228B8755571643E335CA27937197416595714BD8AD5D13137448AC314B7734331244413D58B52BE1E2FF52115EE732A3A5DDCFB17D69FB955849A41E3FCC8D6293E52169D39CD9128539FAE29B51FA29C8568A664E99EA2664F56DEEF3775F717BD7D3C185966B4B631B762E885C7B5662CACF34BB22D54BEBDC1EA16EC518AE2D8D4A8ED17253CADA768866792E93CAF5E366837F5398562332AF7818E9AA3168AC526B8A61A2EB41C51A51931A4AAA2B66D39556DE7B923DDAE928B297BB146DA3F3F4F426E378FB355BCFDD6F8D4DA512E75DAE3F1177B1BFCF71C4F42A83E8446117EA6EA55D57C86A89EF479C1FB5395BFA56872446A7689D8E4CC5FC4A8D3483D5F531F6DA439481234D73AAD2F7DE1AAFFC7E95FDEF8D1A14E7E8932F9EDAF81EBF55BB91B1E3A6D94B84D13E68F67FB2E7613E25F771CB1F71BB8D9EC8B3F6C5D267873ED1E1B7F97A5EFD4B6E655299A6F2C9F19614C8D392886CB3A87618EA5542DA96FA2B2E5A75AC1CF24D84CD52A8A733594D5C31E958CC43EE8D9BAD44DD378EF3BBFD4D68C957435BF5619A5DEE4DCB8767B9B8971DD4796DDC56D1B3EE8A9F87D378AFE343D2B46F7BCBB7D26C36334F5BE72C1D6DE11C777429A727355678C3AB1CE1156EC6A458E698427E6B44A7E52688E8C4DF1F35E83E861E4D1E9AD76645D9C9C295131EB353158B282A9E8744B2CF211251C567FA17682F7A17F1DB4947857FEBFA8C8EE85B7DA58BB7B9269CC894776D15183E772DCB24D428CBDC724F5A627D78C1D3FE7B28EE47EF234147FF9D272F6E7B161812768A56268C6CAD332423A782917AFFBDCA81F1E8CBB68D11924AF3B93A3215FCFE5663D2DFED56D578EEB2753173CD63B2914D995E6953D3331D4E266FFAC6CEEC632EB658692A34C48892D715152C3F9922E473BC3DD68911112679A7DBB1A41456739A63E3F6B7D48E9E8AD558CE349EA11A2D4FF4C2AA59F5F7EC43479639BC9BD2811EB5FDE56D15CF179BD98733A35754FC2212E6DCBD17495DB9D41FDAA39E6F281317FD3A2A86A436DF1D7DE1F7ED675E95519E2A8AF3D9F29FE7C574BC193C7483411C2F622BA8CA731B7E69A69527F91A11621CA9EC9267BE29CEAE43AC29C234A8D2B7213A312DEA729174A18B1B53FE3CFD31ED38D45BD34D3B253174BB6A18D7D18B52325EC927EB27FC7EF29C4AC1198FBC15DC31DBFBE82548331C74D3C5BB568C2C1B5D7485B11FF49F7FB42EF49418825FD1CBBB7637C22D884A3D8382D99C25B65E179E5B614E5C7161D635785747CFC855FE3418BC78F58C552F18767ACA1F2648B7336EE4DDF5A513B132D9313B1B8B4326CFBB38FAC1E449562964A86A3D5DFE4C56EEE582D66162DEAA34985B621C7BFB1596A287E5EC63A7C43CC7E98ECE94128A7936F1A5C7E762A8DDECDEA24B55C46AD814829C17A694DD939D84E46A82E5BBC3EB5EE56826C63CFC987FB49A5EE792AF4ED3AAA37D8A17D26B18E12AF71FF26474D15EAC49D4125D4C69D7346A35C1F34CBFB536E796FEA3AFBEE5247C83CFC7B7DD413974679F1AF49DF286D7F16C79A565C1D3431CA269C6DB852C31D94426FEAB6F6996C3EA327FDEB63EDF72AF7AD8C4E248F825957F4467185DE3E89C96C61A7C96BBB4F9AA4F14EC1C67CE35C6A419F96AB85A1F546C759886E45818EAB6A361C2823987CDBB9B3218C5F4C5EF2F2FF5886215943BEB6146F83FB6B15516BFB3784ED437E19B9D28CBEE12F66731D5ACDDA29C8E58A5C3C8DB7D4DA94D189A46EEE72DD667A21E2D1824C44784E1D3EB8CA9A7775885D99D828B5B24E85323E96F9F6F6AF66CEE2E71944372ABCB52BB1426BF725C5A26F8E9323AA4C669714EBC46B2E7D426116E187A22D673E6A9465F3812E6CFBC81389932A779A564D11AF428CFD87FBE8DD8E798E88F45A26B3C6449A881F3E78466A65FD56291A63C38FD81DF242721A76CC33AE9379CDBF7A6426817B96CAF3737168E6ADED21C8A933E3ADD33A4943CAA921E3D47EB3DC37E29F67988D8374584D891C47AE2E2467CE62CF1449E2439FF28F54E79F5BAA9E1F7CE88986ABF32EB2615475A3FB5995F185F7D747931B24C7B829CBB46F47B3EBED9BBD9B71D8B166876592FF83DBCBDA86CAAC52C31837535BEE4D53F2D3CACB8F52B1A73B6D93FDDDB1A7A188A49D68CA27BB55639E5849C61DDA552E13B6AE8BCAE2EBBFAF7584A88E2D4BBB5E86CF9917272C63B47AE997724246C845E8B784D9A65F973F82F1F7938D8C548A338ADC373EDBC82412BFF497183DBA7557E931156572C9542F3143EBB98DA736D1F797CEB31F3534CDB7F22AA284F22421A276191183CBE8F16E281318EF1F32FCBDAB62BEBE11E7245AB5D34B24ABD188D9AAACF5A768DEC38EE52A7AD862851CDA776631DFF2DBB62A2A414889A1D2CACA89139521DF39C43DDDD25DA6DF819BB943B5E45B37B63D4F2887CA4993295C29645B89D27989D31F28DE91E2BFBF34FFF4AEC8FB1E458B4AB1F49D6458AEBAE2D8F277CEC745AE65F58F9DA5C448521311BFEEDAC8E674ADFA41ED5B88AD1A72A21FF5A358934A7A4AA377D6EE3F898A2F91B34F342DD879993FF7DD5F4C136227AD9D438DFC57C67E5659A99ED98AAA14E28247EB4B9F1F6C5A6EBE4FEC1FD9BBAAC593FCD83D7F13269CB431F314B3ECC3255882136E2693426E58FC37FD96AC8394A8C2A284E1D22B16A72CD926E3965216ACFBD76B7458EC5F3ECF75CC7593E9F85EA9514BBFA1B7FD534377E5CEE27E1BCA492E4C66C1CC68E92D172451536C526FAFD6BA38B641591661CFB877AC3E51D7F24AC69E3467D6CAEF197781AAEF23D1413FDBDF73DB115EFDEDB65683C959AF14FD644CE17E84CE82B38F8F94854944C313EB6C35AA8D8FE32D9242CC61C2B1B4A9EF594E333B225B664AEFDC79DA98D323ADBD4E1619ECB59EE86B4CB165FAE1D868D9D5E55D9122679B24FCBC8B7E3BD8AA1867434CACEF3E3BA2E5D7FB5A69214AF113347C7C49A64BE91BF7EB145ABF4A745AEBDCE15FDFBB8BEF2C237643C7442F57223FAEF7DA3C513DC57A2ACE18997DF9E28F7E7489849A2CE861AA622EBFB281481A676E7597EAA5AFC41252F7929194895E7A456CB5E59FCC3CDE646ECE65966DBCFE252497996C58F9EC4BAF1859DA68DCDE2EA26A336E35812BB3B327BE18DD5A461DED71F4F2FE981B3BD498398FE422926E64F5E6ED4764387FBFF517CEAD7A6CFB7E75B52ECEA66859745E28C3C342EB4C931C73AA1BFE3CE27AF1343E6E8C9B89595C37DA95841D578B7AE2FC7787A77E7429274AB3DB8997C8121FD7EC58B3D26F37DD987DAEEA5A2C3941F94B1EE584BA38E3F5F1BDB7E442DE247CFE353AFEB2694D5BD78FE7498171454A36E57EA278235ED95C93ACB24997DD2F37CA5D345C61AAA663916B99C3797F11742B156D8BD2C77317ADAAD6456A4DBA1CD9836F6382A7B25CFE7CBA82CCEE672AFADC13E9BF779BA8A1B534DE74C4A5E1E347C2F796528F1273E9DBE4EA8FFD75FABB4224EEC7D4FB6D5413EE5D6BA479EAB9B5C23FF73E2F46A419956678AD1F74FA8B3A221479327D57D63AB925DAB5DA65CFED868E6B8CFC3C9C65581A2CE66BA3AF72CF72AEE138CBC97188A14F6127A3624213B28122F5DBDB4D35DDCBED28189B115B2D33637ADC619866D2836AAD2B9935559E7F169E2E6AEB734F5A967217A446FC56B5BCA4A1DF3C2EB6FBCDC4CDEFBDBFBEBDAD2B563E244423E582F4F63AA515A3A47B73192A45DCFC875824DB577C427DC5FA87A11ECE2B2A96922DCDB42EC83842AB94B928EBA75B55CD29AC4BBFADE6781FC4853E7C5BE1FBD8BF5E2754BA92A11D419DE12A3F33AFA566A8CEB81B9AB2E727B77C1AC34DA53F3CEE39D3BE47F251FF7ECE8F93CAE69138FC846421219D88C66FC565E3ED8ED2D45D8A19A9236139E81A56E3F4F895178647FB82B948161E688AED4D84C28D8733E9D6A866FD37CFFB151528F69E385CAA5E77D4C4263562F66FAEF9487D8499D685CCF811535ABC1832D2B92969C72AC168D575DBE961CD8FEC8159AB262B75B4CF13BD59D21AEF15C8582E3ACB5A78E3EECA32AFAB19A15D9962FF3B38C97AC5FFE98193B13C2722F7A6DC8F4512E4763CEBCEDEF7B8D49C2AAE62E2663C912BD7D962858A45DC9ED343494AEED7EE3B57C294D15169C6E18243BE49C1136AD31941422F2E86B66A81CAF83B8AD6B38C33CE455DAD35AFE91B3FAD2277E3166A9984ED182A53A3C25E1E398A76C74924217F5FF6949AD5B3A31D48EAE292AACB233729C34C4187AA9BE4ACEFD78784997BFF449EFDF84994B7863DC7B55A8D361AD45D34A9359B159F2B4D9E2D8232E333D71732FC79FE58D641346C2554D3D16AED28E15C14A5BEA665A31375DCEA4B428527D6A59CABAB28F3A759395938461432A77BB77CA9831EC2D1AF1E83D4FE7978F63B427DA67A5332AD8A38C1B462CC1C93ED4CA53267B9F667FF64F17C931969446E184A198B971E51EB453A9C49CA2F5F6579679D93BA812D353C6381BCA437383919726142239313EAEBCEB7AD2C45565CE4DCB8DC3D63F44DEFB1D5DE28AD6F9B3E75DB1F862715C6B7684BECA89FE9B872C554BC95B1176C54B8694F947ED27BA376733775F73537F67C6A4E6AD33BD4D5ABE4A5F932568C3E881BE6C3FEDC3284D67E2675EB2674C7B4219E3847BD9B1D1EB3B9E9BF7A3A15D9DDEFC3E7F721BA6D42D228189A2966A338AEA86A6E28F75389421B9253AB8BDB479D66EBCF3BEEED79EF5811A2B9D141E5552B7DA21FF6DEEB5AA5BBDD5A5F244EFD9D2AE2A67EBD9F7B4961E23324DC9C922BCF4DCBB7FB6D61E49CC3E5D427F2884B888BAA396FD38BD87AADE717D79D7C86B8159A5E23995684F2868FCDDCA4999B8A124C7CEF5B64EC562556222362B6DBF5CB137F342F7FB45D81319B3ED55AFBEB6E65588676C291618F12BA78F396E72BC779666CC35CA3D325BC72B6C4BA24C62B671BAC571F9D929B6741CFCF15A5ACF7AF3C4E34D38D48F1F4233524948B7721DB41A64EFB4B43BA64C18649934F1C7DFBE189EFC9A7CC191C982482D38DFF36286114F451A1DA1DE2C7CC9AE8ED783FFF884EBFF6747785FB4C7466BBAA459348AE7DDD34813FD221D94A6E6FF1B1AF8C56933BDAB71893FD338895EF52F6882CD";

        char* num2 = "A68CB98227A4E8D87C1328E374A6674F43CE3B1492E71BF7E711EE3635BF36E6F2534C6DD54E7AC69D673F4547B6CA443867BB487EDE1A49E1F1FB6B28852B8CA5358D5E3243BE31EA265E8D672F32B4651D2C4BD761D81B298D7FAD7CC15EBA33FBE3641BBDB314C823FBFDE3531753ABDF5B35D5A88244156F7D4DFF787BA16F72227E68ED9211DE14BB12B899AB98A793871E66B6E47B2EF4975B66481472BF43EB8B9B2768376926FD2D3C531B432EC7253A741C33A83B538D7BAB52D14EEFDFBF92A25CBEBE97895EBE9FFDFA369FCC6D5FEA398579CE284C6C3C9A6CF63B29FEFD8A7F6589B11E4637931667C9952938622428111B999C63AF6A5B88425CAE571D39C315D1DDD3179696115C9183F42794756E9AFD7487214ADC338B37E9B7F4ADF74113D7D56ED19AC34BD733F597F3BE1E6184F5FC44C46169B37567165F1F616B2D683D4D1F8D7D7A7DE4BFA76AE324638B22F568CD5323C91343252E6F28A72294B18184E4EF7AFECB15F9468C59A6BA9DA9D943D234492FB95B3F823CB49DDAAF378DA5F483419FA524415D471C4E6D5FCC5D2B81DB2D233ADDA2BD13248E9C6C9A9251993A654FE1D1AF52265255DA1DB1EF18F495F5CDC95DFAE8FB9BF7C8B78AD99C499A55E254E4D534FCFEA3D5A66E66317BAB78C3B36F7F4633BCC99666CB4E3A1C574297B662C9EF31BF1BC6988CDA6DDAB934FD156D64CF5EEC23AAA2684BC8C81F3FC4C382DB19976A9F4A8193B6B8DB773AAE49724E2557E5DAFDA8FD5A52D31F425FBB8E993689ACA99B998DA47ED759898A4F158AA7AB44CCF5C79E3FCFD2FDA77667269BC3D7794D57BE5D595AA47BB588495CB9E9FC9A9E25CD986D279FA4523838BD19D7D796CA2FEB7C89A88B3456B756BC79347B13C323DF6CFF5FBE3746DF3FB9F6468CFCE8E38B67A26C113B67B87D963443FAE534E2EC8FD6456D1B53A3F3FA7ACD5A3ED8F34E2945D935BE768EF7869BBD5539C2B8FC1B9DB3AE184863651EFB34F543DEA532F3F251F5834ED9A5FAF25679FBE2F836A9869EA2257661A5216ED474FC56C8C61BC29D32A1EF8F4AF98456FB9415343B66CF361C67B566ED7D8B37643D852A77F3DAF6DCC1226F6C5E7E54272A4ABA8BDDC4391692E7853C32BE5C6DD1E9AEBEB73573A848EB41869ACE62349243FE22C46A6F21E7B3FAF8BBD941CC97FFC11FBD91C312934F5487ECFAC36C9C3CC3B7F5E3E65E1FECA63123A65F96CC2F6DED9C77A35A336CFFC92D6E5EB82C781CC9137A6CB861BD7F61C3E1898AC79D3563EDC4173DE6AD57D19B99B1377342E24C68166AACF59436C485CAC68B84C6572269E4487AC7E742A3D6C934BA7E73DF4312DBAB5D2AB5B5782394E4DC3B7FBA934ED5929BC57E9E738F6DA4A461A824AC978912B4D32D88FFE6D11E466E6E9FB2E3A6BD9FFAD7ACDF9AF9F47C9CB2B6A1FB638E271E52331B48C4B3FBE2C1E69E8E8151ECF4D965B9C747942E55742F9A58A188CEB1716A221512F97CED7F4F99EA963D55D3DACEC5ACDA546A9C2C3A51C6D6A9AECE9FC5BE8884C5E5878A8524269BFB93922DD5BCC31FE6B6C47488F958B4A464DF1243E7CE7AB2FE569458C987D23A571C8BE632B9BD2AB7752B46CB41D629C3D5D3275D7FA92D7F983CDE82ECE7C399EE4F584CE6C733EBA1EFED1496AD8BD61165F986EB48D2AF29E76627B4446896962F7ACC515A269BE79CCB376D2B5315825E313F8E9A42C3F56B789CCBE1D6DCF9B2158931A696F825A944CF638385E7D11D586E1FC9CB9E83E3DA334ACCEBAB3AFFA6DAC9A1C3EBD4DA57591156B686185A59B8A58DFD8C1CD6426B3A95F8A77E83F3B9FA6EF5A78E431963AE72D985E87D2961436AE717651656FFB6196FD57B295F1F9798516AC6F2C61EC179FBDE7F736E9EC9D293B613748E2BE155B239813DFB4B41C5BFA328696E5BE97A22AA2D7882B43E85D97E848524F14D25EBE88DF8E23812CDAAC25B676C791FDFA4EA15967BE7C24D47682BEEEC7E3C5DF3E787CE92C54F97EE679C6EFCC382FEBD53B984A4FDB8B969F655B42761FCF31B5B456E853346B1EB6A78D87B16E7FF952D18384C382D87F61ED6D48D26B1C5CE9C6BC17E8131EA678345EBAF85F594A2F7437B1F34F15C7C6A14CA357A1FDA941C77EED89C9DF796929C3411D81291C94A8395A29A7827D28ED3263EDA7EA37E568D396B4C3C485362C7EFCC1AA3C8886F58F33AECD94241BF796AC74D9868F3ECADE484F55BE839722DBEBF3BE83D281B5E64A61E8E6AECB71EC35F53E77168BBD267E65DBAE9EA16FC94B56A4429B449CA7A7CE3DD3BEA9DE911DD2113A475436A5D63747965BE29E29C63C75D2B3568EA5C437B4CFE39E1A74898E65F87BD79E3C363D974E1CC8EAC6BBB1F28EC6CC4E1DBA241698951EF4BAED25E9A2666256EFF8B854FD174F2E17C2C2264F411FD6E4D1B2C37C1A33F39BBC5CA8BDF3CC92FDA3F6CD2C7BE6DF98BDB5CE9B85E1E5687C539DF785C54C4F96BCB5E41CBE21DFC2A5E9B65F2935F432FD6E172CC34AA1B4CA4FF869885EB71BCD1C42F8CB26BC1ED4D533D3328D9F8CD8882FFDA1AC5AA95FDE928B4114F8FC8EC15BD64E2FF48BAD9AE2D99DCFC3C498BDA8BDDC4C7C78183E1F89CB886B4EAE3CED13257F8D88C26C85CB8CADED394CC92CBA12187FFA1D7F9AA165559E54314B4755FC46C4848E41F5261D22CD5E519875C618443B8A93AF73CF8D142C96C9E3529C1C137FC72EDF8A6F76A13A66AB9E59B5C38A2B8A1511E7FD42DD3A4DD4B2CDDF7C9F811F52FBF783F5826BE3E2B2691D59C4154CDA7C1E6FAD98F7AD86EE663A666DA9A7A8ABE82F5A759298EFD45F53DAF7A9652777EF6B2DFA6F24EFEBEAD35426572D5844F9E165AB4B6A2BC861AA4B78995E182F277EB126477C3348AE9E1FDA83F1217AEE9162698562E11969E71B88D7F7E71CC14229325834F446424BC3B29A8E88241562583A7D56883396E5896835DBDEE5AB6FA111D5E5417CE58D56D8A2AE1F32B98518DD4B9737A843D88272318A8AC3A4EA43E7576F67799B88CF2F791EAC8587EB9D96B651DB9DE9D2868EE9D8CCC4336477924D38F3653A7AFE1D75C411EBACE1AE2DBB626378CDABBAFA6356A314664F4DD6FAF5C658A6ACF165322D5A1AFC241E1F8FCBC83DD4AC478D91A5A36A6756CC5441EF88DC3EF657B5F599EFA4D61AA6DDD44D319DE9AB75F6297FF8BC6B6F8B4667AF83CD37FA3F74F5B656228F112BDE2751126BF5C943D3F88B52CC8441E8676A873D99253DEF7DE7838B67EAE494BFD3D17618A3C894D7AC1987FD85218C75E4CC9D437131BFE5BFD3D41582CF54BA7F6841AA8423317EFB8CE88D1B45E76D6BC1CD242474B52282DD1CB276DDC4296D92A3DBDB78789E1DC2973747B12C981A1B4DD1F48748545855EEBAD7AEAADBBEDE3AE36D195C41595AE84B6DAFFE2ACE1F969E41EFC2112CB84E314413324684C8A5D5CB494B1D8B532E4C3B6C492B5636A7AE257D17AFA62B4CEDE41343588F596E7F45CB4DAD33FD7DB51BEB5444385FEBE98A4B7581EEE5B923BFD1A8448846B2EAC95A54B321F49864EAB937CAEF7125A55669183989C119CF4EFD5B7435BB9D753CD457CC115898746D1B9E6338D35478FB3B36F364A739A863A6878BF5548C3FE5A139A845665162A782EF4DC98BCB2A74394C988E5462679D9E4C37CAAFCB24E44A742FAD37FFEF4EDF276E17D53EF89321EA78F1EE1C542934F12776B1CA1559C343234F8B4465C18B119E757AE76A73CACD47539F6F42F4474DC22A37899F3596A5567D5DCF633A1EED77725F2DE4AE1BA512A56DBB16C142528C3D34A8EB6768369C26AD82359D6E66293B443AFF1C73377BC18592126D7C3FCCAF1C17C83ABC228D979919A679298D635D6CB2554F258198E316B2C9ADA33FCE42AEBE3E5B3C33B95BE8DA17FA191C74E899747361F9329FD77297889181CEC26524F876FD63EE23CF45D4464BE79A97EA26A8B9C833DB5929EF42C75A554DBAF5F142111B3D6EDFE3E252F1C557988FC7FFF177B94882764CFFEE723C84413FE366ADC5D84C133BE93479525558C7E21C7A9B66AA3A4C5957D3894C5FC1EAAED816364476DA9ABD887F8B452FCF166EE648B7C3414C2E1AD81DA4233D3B4899D41F34965DA632781F52365DA78D686ABE9D23BD7CB1D9868C7B9BF4978EE681496CB8A94C9859DDCCFD7E11CF625628EE51D618211D952611AF6AF21C369C5729EF667E7ECF4DCB66AB71585EDD29C43A3F116EF25A62C3EE6D6ACA898A2B5B5E3CE825176DFA1D8DAD768667FF2B2D9B28334A9A884FD3CEFACEF9C7FD293B44AED58E67D9DA31132C89C5FC985BAF6BD41D96B67189183AB337793F8E33E8533CFB3321311A844A6D146B3E958E5427183AABA4BA6359CAE4D4E89F48D8C6FC696747BE11861B7EECA5B3BE3FEE6523DE985BD5352B799C5A1F5B57BAC8EDA3BAAF6EB8AD31D4D25589847AE3947A72488174988395DDD39C38FA95429BB7476C7477CE2C3E9F89BB22CAE74726564A9BEF92DAD79D61683E161ED4CE11B53478AF97A6DA3A2F9562A6FE14D14FCDB355AD44A85436B3A14C6BADEED2E271BB5518FA146A214B18ED39A8EE94774331E3F6471112155843CD3D52C5CAC1CE8387F3EF469B25B577925DA8A626D6B5F34EC25FE5B196C84698337CF9956415D43ACE9B4B3C1E4C444ED32DBB21695BDE51C5BF1D484747BFC82EC415BDE78354389EF133861453A83B666DB131EA33E52EA1E5AD2316CA6EC3C9179AE7B1115AE72CBCAC62A2CF8F2499293F8E78E3959B14E28442C78469E6A7FC672C68F7CF2C4F6BA94DFB9CB735E99B7AFC26355B2827AB7516799AFBE54E1A9FE25879BF9CDAF4FF1D897E5D4FB424A7D66BE1AE5E942FA9422B7D8AD356EEC3B2D2AEFE4F9C635AB6C244C8D1D3715999A3EA8211D7398DF4F3E323A66862263B18C82D1643F38E6E8B19D26AAB4B86D85A8678C22BB111E8368F8529F5BE28769EC7DFFEAAF22514B8BACC338D89CE6642C18C7966AF2A3C95DC876F4EF8C6D8E187C6FA3A15B385F61747E85D78A4F9BFFF561F7143AB79878C56B9A99548DEE4DB1DA855AF7187EF3BC547D4B84F6234438D2D9B413B793146CEC137866DEF83A87BC1EF88AE146BA2AD245192DE9D1A5F51FAF731CAC26D37ABA6BAFF88C128FDF6F642EF3A1FEA68C76E85D842F59E91B86E14D45533E13278F7CCE7DD3E3BEDBBBBF8EBC9E29137F2D3539AFBF2DD68F14EF9232F427D966DFB18C7AB17F6FE735D3615CBD39DF63E83641761D57C456F29525152A579A9EA3BD3244EF2B3689E158CCC661C6AC4BEE91F4BE3C1D9F688374E3953CA486F64FEBA91CD8167E5E1B3ED3A77C3E29CC827927CEEDCD31B3458183F6E9B72731F29285FE9BB34D573572ED7462AE14EF5E15B8A43C7693CBEB4CFAF641445AA18353A6EC2CABEDD5F21F38C6F71413C1583EE82F432A1FEF866AD28D9F89249644B2B5877A1E16E8BB99D1D68C698F7BA9CCDB3C5AA5FF4BBDB8DFD5B36394DAC17241D8B75278C9571A6569EBBF619A87BB88BA6FB478C464D483C76EDB66C6D71C6B642171FB46E11EA4CF293FEE53DCE3F461551BFB15B83DBEC5E6BD5F72B6B29235DA14D8FF83C381EE693AF93BEE4F7DBBF3EC3DBA7847835D37F3F95678CD67F52D143359A8792BE59579DB65A29FF9B1D3BF6F178719365BABB7D83894E14A81CB89A819E8A8DEBE2DCE6FD6AC6DD6D11CA24ABA9C96ABB3972666BF294E6976517129AA5A77629682B686C161FB9685D75EF6F51D36E3BD56A43741EA3E7B342891DFC5C6A29C759184EB4C6DAC858141918CD43763B4744EE3926678AEC27F9F71B45D327D5D8FB72CFF9673C3439D2FD4B99D2F26D9DF7E375C4B6F529D6A536F4EC5D532DF255B3AE655D266EB835D2FB5CF9E2EDAA9543B9FFD1CB6E39A7229ED8EB14F2D8713929F61B1613621F39DF9329713B114A9C382AA3FACDBDC6D156A771E94E9782A21BBA5342F66333A81467C47FA7D9F7BF269EF4F61584E93EDFC93AF414D7A863561C172232C2A6775B77C63D1FBAE25AE5DF4F861BEA1D958F34D58DB4F1C432FF83E7162E89B1DA71EBCD9F8FFB32D99C4E445C2C6DC37AAC6E26D9545ED976CA4F58C7B9BEB99DDEBE4F7833DF34CF686A79832315492174E23C1CFD499F8EEEF6E8812F5596C71A13716DE96716CEB349239435F32C92D1B4228F26D2B18633656FFF462622E73A243AA4FE62E5E174C4AB36243A611F2334448A25BF997F44BE6DBE2D9E51D7A7AD2973D99D27DD2F38CDDDA636E7C8DEDE7485512DF6A15CF29D6AA918F41525A9F3D4A6294B28F11FD7A8727D5E9E3473DB671E8B294114F6215F2BDEA6CC1A6D5CCC24834334DA9FAD64139A1CD16462725854BF653BE42187482C22F7952ED8727BD9AAE55486475EF6A871E75FD9E4367F6894C6FB333722431A4F9FE61513A72FF2B3E2E9B8FC147152F58628A3AB932FC43A5831FA4F5AF137DB4EAD15F2E11A5AC92611757B6E4951B8E5C71B87B817341BA8C1CA438E34ED349EA219842FAB426DA9D6B8F362EB61FF7187AF23EC59526E3BCD3B71D5BAD29B3824EBDD7263A42CE518F8844BE1CEB6E59CF69DE7F92857C6E45EE89C153BB17BCD9D27B9FC85A528F6DD5D253485BE774FB576D696232A31F75C561E9834E1321D6EBB4B8D61788E6CAA3283A2E8389AC68E8BA7FF77E6C43DECED68F47237BFDADC5E4CD23386723C589A1F6E886AEA44692157AE92B7A5AECBF4A53358CA21DE17FCD92D2CC3161487834AC8989AFE8F5E39E4DF792E793E128BB434C35314A5AC5883FE38592EF9F742BD5EF181B2C562DDB43DBEE4CDCBB7CDB833FBAB46F9E4D971736CD392DB829B9BD9DEB242AA6834F1D5CBECCC8B586D3AD18894A3D727288F5B238D67FAED817C87C82DBEB45C4438F42E88582351ABDA912AD4FFFCB3FE269342A89C2D44F8D186ACA2B9DE34C4A5D5D856B6AE9A7DA64B35C551375E26BEAFDE68CFEC15A2ADD4919D2BBD2C342C3F3FEE7CA71B938D68D6562F3335D59F4BF916624DD4FC1D56393B1653227A92CFB4C16FD3B5E39A8343E48361C5356E48A7FF6D919E429344C9E44BCFFEBD465DC5C995294C246C7365D9F9F7724B7F8ABC3B8443FC6D9CFE1CE86DECE9EC8E6BA862425ADA76E6B6A9DF633BB27B7C61C39745197F65522EAF5898AC12775CE16E7A4FAAEF6A1713D5A744ABC1924E99D8A8E42C4EDB5DDAAE85A28621EC7F54E7BCA4F52C1DA5E446FDE7A7F1367F156B176FCEB4BC8273777659C4979F614BBB982564F918AE28C9D222C286156B79DF8ECE9B71A8F4F3C545D16CDD1A8EACD3211A4E35D28CBB8FF5758B2F51DF4395317669B32A6C6E35A923BA213776973B719C9BE25452987B8F5496B3499CF386319BB747289377D76226EC93C9EBBD8D51F773EF2E915672E875B77EFC9AA1761DDEF3591E9CBFDAEB613CE9FE41E276FBB6DFED5711DD2BF732A139ED24E8953B37B84FFBFC88F7E218A3987A4C2C9B8B2A3C9971D68C4E5B6E567BFA88D1ACB3D5EEEC6B95ED33F1256FF617557F99266844B965E498688EC6D43DA739639F8E74994ED22D2FD9D16348F6F9ECBE3BD1E6A25EBDCC41C213452AA1BF5D578286F9FB7AFAD4A95B3F7598CBE89371CEEBED65E5FB81B4BEA9AB8D666E9C752C7F9C4E8A18BB3D1D7286F5C5BC82195785A339538F5346FA7E86A425F9D7925866B8672E6719C7BAC386D9BCA8A32EB7BD71B8E16612434FCB61B8457DF832FD6DE1548B2F45AEC699E5121EF7798D75AC56F488445D21A398E1AEE16C9597AA368AAF2DA62CDBEDBCDC244EFCB1B5AD297B91FAD1DB4BF6ED288CDEF8EA41869689684BF16345899118C674D5D9CCE63DEF59A5A7EDCEDC66C3B368EA1B7689468FFAB11A5482857479642B696C75C2BB825496DD9C611DBFD1A647713D66682D161935DC83417775E8A2713958FA78F7D7714443DEA551141A573E7EDD145F23D8A135413DCF6C3DDE47D262F6D4CED9EE283C8D9BC6763C4DA8FFAECE9FCE92C2AFD2C65F4356E8B98AF9FC7F3ADBCA4611E4E33267EB694D3BD9E491E64A777785A6FCE5AC71635FD39BD2BBE6C6DAC5FE262F2CB848A887289F9C2E264EF8A663BE2CA5C5C6DBD63DC39E2BBC1A4311C3FE71A36D8A9C73A4639E54ADD675D3848E5212FF3FC926C7FCCCFE954F9898C2D835195381B2DFFCBC83A875E7C87F94739E4D135442A4DC7DE85CC4BF32FBCD55C894BD76E114DE136CF97A993F4E41BF844A22873827799C6F6C1663C12F8C78722F39EC9F3F9C363F245E687E8E2E69FFF2FDE8D8EDB23E1B2D275FDC5E23E19EA83F8776437D1819C9718454A66FEE5878E6ECBA6AED2665ED5D19227725DD4B521B5BCB5A8D1E9E3E4AE5C5359F24AE529A55C9E4E697CBCF6BB97DD85EB6C18C2C8DCE8A429FC569712EE663C88F87C1345F2D1DE9C26AB4A428AE2D72C688E3432C729C36EFF131BC1CA298A66A5BC8D55CDD87A661D92952C6A66CB3DFD9F254D2861336A16B124CF62524E6BBEACADA3573E9911E";
        if (!num1 || !num2) {
            fprintf(stderr, "Memory allocation failure\n");
            exit(EXIT_FAILURE);
        }
        size_t s1 = ((strlen(num1) * 4) + 31) / 32;
        size_t s2 = ((strlen(num2) * 4) + 31) / 32;

        mpz_t g_num1, g_num2;
        mpz_init(g_num1);
        mpz_init(g_num2);
        mpz_set_str(g_num1, num1, 16);
        mpz_set_str(g_num2, num2, 16);

        uint32_t *h_num1 = (uint32_t*) malloc(s1 * sizeof(uint32_t));
        uint32_t *h_num2 = (uint32_t*) malloc(s2 * sizeof(uint32_t));

        mpz_t temp1;
        mpz_init(temp1);
        mpz_set(temp1, g_num1);
        for (size_t j = 0; j < s1; j++) {
            h_num1[s1 - 1 - j] = (uint32_t) mpz_get_ui(temp1);
            mpz_fdiv_q_2exp(temp1, temp1, 32);
        }
        mpz_clear(temp1);        
        

        mpz_t temp2;
        mpz_init(temp2);
        mpz_set(temp2, g_num2);
        for (size_t j = 0; j < s2; j++) {
            h_num2[s2 - 1 - j] = (uint32_t) mpz_get_ui(temp2);
            mpz_fdiv_q_2exp(temp2, temp2, 32);
        }
        mpz_clear(temp2);

        size_t s_res;
        uint32_t* final = multiply(h_num1, h_num2, s1, s2, &s_res);

        free(h_num1);
        free(h_num2);

        char* hex_result = uint32_array_to_hex(final, s_res);

        mpz_t g_mul;
        mpz_init(g_mul);
        mpz_mul(g_mul, g_num1, g_num2);
        char* gmp_hex_result = mpz_get_str(NULL, 16, g_mul);

        if (compare_strings(hex_result, gmp_hex_result)) {
            printf("The strings match (when compared from the end)!\n");
        } else {
            printf("The strings do not match (when compared from the end)!\n");
            mpz_clear(g_mul);
            mpz_clear(g_num1);
            mpz_clear(g_num2);
            break;
        }
        printf("\n");
        
        mpz_clear(g_mul);
        mpz_clear(g_num1);
        mpz_clear(g_num2);
        free(final);
        free(hex_result);
        free(gmp_hex_result);
    }
    return 0;
}